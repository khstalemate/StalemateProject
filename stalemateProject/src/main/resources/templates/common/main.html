<!DOCTYPE html>
    <html lang="ko" xmlns:th="http://www.thymeleaf.org">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>MatE</title>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
            <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="/css/common.css">
            <script>window.FontAwesomeConfig = { autoReplaceSvg: "nest"};</script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        </head>
    <body>
        <th:block th:replace="~{common/header}"></th:block>

        <main class="page">
            <div class="layout">
                <section id="adoption-board" class="section-card">
                    <div class="section-head">
                        <div class="section-title">
                            <i class="fa-solid fa-heart" style="color:var(--primary);"></i>
                            <span>분양&입양 게시판</span>
                        </div>
                    </div>

                    <div class="posts" th:if="${adoptionList != null}">
                        <a th:href="@{/adoption/{postNo}(postNo=${adoption.postNo})}" th:each="adoption : ${adoptionList}">
                            <article class="post-card">
                                <img th:if="${adoption.thumbnail != null}" th:src="@{${adoption.thumbnail}}"
                                    alt="게시글 이미지" class="post-thumb">

                                <div class="post-thumb no-image" th:if="${adoption.thumbnail == null}">
                                    <i class="fa-solid fa-paw"></i>
                                </div>
                                <div>
                                    <div class="meta">
                                        <span class="pill" th:text="${adoption.category}" th:classappend="${adoption.category == '분양'} ? 'pill-primary' : 'pill-secondary'"></span>
                                        <span th:text="${adoption.postDate}"></span>
                                    </div>
                                    <h3 class="post-title" th:text="${adoption.postTitle}"></h3>
                                    <p class="post-desc" th:text="${adoption.preview}"></p>
                                    <div class="meta">
                                        <span><i class="fa-solid fa-eye"></i>&nbsp;<span th:text="${adoption.views}"></span></span>
                                        <span><i class="fa-solid fa-comment"></i>&nbsp;<span th:text="${adoption.replyCount}"></span></span>
                                    </div>
                                </div>
                            </article>
                        </a>
                    </div>
                </section>
            
                <th:block th:if="${session.loginMember == null}">
                    <aside id="login-form" class="section-card login-box">
                        <div class="logo-badge"><i class="fa-solid fa-paw"></i></div>
                    <h2 class="login-title">로그인</h2>
                    <p class="login-subtitle">MatE에 오신 것을 환영합니다</p>

                        <form action="/member/login" method="post" id="loginForm">
                            <div class="field">
                                <label>이메일</label>
                                <div class="input-wrap">
                                    <i class="fa-solid fa-envelope"></i>
                                    <input type="email" name="memberId" placeholder="example@email.com">
                                </div>
                            </div>
                            <div class="field login-field-spacing">
                                <label>비밀번호</label>
                                <div class="input-wrap">
                                    <i class="fa-solid fa-lock"></i>
                                    <input type="password" name="memberPw" placeholder="••••••••">
                                </div>
                            </div>
                            <div class="login-actions">
                                <!-- <label><input id="loginKeep" name="loginKeep" type="checkbox" class="checkbox-spacing">로그인 유지</label> -->
                                <a href="/member/resetPw" class="link-primary">비밀번호 찾기</a>
                            </div>
                            <button type="submit" class="btn btn-primary login-btn">로그인</button>
                            <div class="membership-footer">
                                계정이 없으신가요? <a href="/member/signup" class="link-primary-bold">회원가입</a>
                            </div>
                        </form>
                    </aside>
                </th:block>

                <th:block th:if="${session.loginMember != null}">
                    <aside class="section-card login-box">
                        <img th:if="${session.loginMember.profileImg != null}" th:src="@{/myPage/profile/{file}(file=${session.loginMember.profileImg.split('/')[3]})}" width="64px" height="64px" alt="프로필 이미지">
                        <div th:if="${session.loginMember.profileImg == null}" class="logo-badge logo-badge-large" style="margin:0 auto 12px;">
                                <i class="fa-solid fa-paw"></i>
                        </div>
                        <h2 class="login-title" th:text="${session.loginMember.memberName} + 님">회원이름</h2>
                        <p class="login-subtitle">환영합니다!</p>

                        <div class="section">
                            <div class="section-card user-stats-card">
                                <div class="user-stats-header">
                                    <span class="muted user-stats-label">내 게시글</span>
                                    <span id="myPostCount" class="stat-value user-stats-value"></span>
                                </div>
                            </div>
                        </div>

                        <div class="section user-menu">
                            <a href="/myPage/info" class="post-card user-card">
                                <i class="fa-solid fa-user user-card-icon"></i>
                                <span class="list-title user-card-title">마이페이지</span>
                                <i class="fa-solid fa-chevron-right user-card-arrow"></i>
                            </a>

                            <form action="/member/logout">
                                <button class="btn btn-ghost user-card-full">로그아웃</button>
                            </form>
                        </div>
                    </aside>            
                </th:block>    
            </div>

            <section id="missing-board" class="section-card section-spacing">
                <div class="section-head">
                    <div class="section-title">
                        <i class="fa-solid fa-search" style="color:var(--secondary);"></i>
                        <span>실종&목격 게시판</span>
                    </div>
                </div>

                <div class="missing-grid" th:if="${postList != null}">
                    <a th:href="@{/lostandfound/{postNo}(postNo=${post.postNo})}" th:each="post : ${postList}">
                        <article class="missing-card">
                                <img th:if="${post.thumbnail != null}" th:src="@{${post.thumbnail}}"
                                alt="게시글 이미지" class="post-thumb">
                                
                                <div class="no-image-card" th:if="${post.thumbnail == null}">
                                    <i class="fa-solid fa-paw"></i>
                                </div>
                            <div class="missing-body">
                                <span class="pill" th:text="${post.category}" th:classappend="${post.category == '실종'} ? 'pill-red' : 'pill-green'"></span>
                                    
                                <h4 class="missing-title">
                                    <p th:text="${post.postTitle}"></p>
                                </h4>
                                <p class="missing-location" th:text="${post.location}"></p>
                                <p class="missing-date">
                                    <span th:text="${post.missingTime}"></span>
                                </p>
                            </div>
                        </article>
                    </a>
                </div>
            </section>
        </main>


        <th:block th:replace="~{common/footer}"></th:block>
        <script src="js/main.js"></script>
        <script th:if="${message}" th:inline="javascript">
            alert(/*[[${message}]]*/"");
        </script>
    </body>
    
</html>